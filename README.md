# 🌿 Vegetable Pricing & Replenishment Optimization Model

本项目致力于构建一套以数据驱动的【蔬菜定价与补货优化系统】，针对超市多品类蔬菜商品的销售数据，结合**统计分析、时间序列预测与智能优化算法**，实现精准预测与利润最大化。

---

## 🎯 项目背景与研究目标

在农产品零售场景中，蔬菜类商品具有**高时效性、价格敏感性强、销售波动大**等特点。传统依赖经验制定的定价与补货策略往往无法适应多变市场需求，导致库存积压或断货，影响盈利。

本项目基于三个历史销售数据文件，设计并实现一整套“预测 + 优化”流程，依次解决以下关键问题：

- 🥬 **问题一**：各类蔬菜商品的销售分布规律与相互关系是怎样的？
- 🔮 **问题二**：如何基于历史数据预测未来需求？如何优化定价与补货量？
- 🧠 **问题三**：如何在单品层面构建组合策略，实现最大化收益？
- 🔁 **问题四**：未来数据采集和策略优化如何持续迭代？

---

## 📦 数据集说明

我们使用了三个真实交易维度的 Excel 数据文件（“附件1~3”）：

| 数据来源 | 文件名 | 核心字段 | 数据量级 |
|----------|--------|----------|----------|
| 商品属性数据 | 附件1.xlsx | 单品编码、分类、成本 | 300+ 单品 |
| 销售定价记录 | 附件2.xlsx | 销售单价、批发价格、销量 | 多日期 × 多商品 |
| 实际销售记录 | 附件3.xlsx | 销售日期、单品编码、销量 | 超过 1 年销售记录 |

我们通过统一主键（单品编码 + 销售日期）进行三表合并，形成了包含价格、销量、分类属性的完整交易数据表。

---

## 🧰 项目环境

- Python >= 3.10
- 推荐使用 Conda 或 venv 虚拟环境管理
- 所需依赖请见 `requirements.txt`，核心库包括：
  - `pandas`, `numpy`, `matplotlib`, `seaborn`
  - `scikit-learn`, `statsmodels`, `prophet`
  - `cvxpy`, `deap`（用于优化）

---

## 📈 数据处理与建模方法

### 🧹 数据清洗与预处理

- 销量归一化、缺失数据前向填充、异常值处理
- 分类层级构建与单品映射
- 滑窗构建时间序列结构

### 🔍 探索性分析

- 銷量与价格的相关性热力图（皮尔逊）
- Top-N 分类与单品销售趋势可视化
- 类别间销售量堆叠图、增长趋势折线图

### ⏳ 时间序列建模

- **ARIMA**：用于短期销量预测
- **Prophet**：考虑节假日与周效应的长期销量趋势预测

### 🧮 优化建模方法

| 问题目标 | 使用方法 |
|----------|----------|
| 分类级别定价 | 模拟退火优化加成率 |
| 单品组合选择 | 遗传算法优化利润占比 |
| 精细补货建议 | 混合整数规划模型（MIQP） |
| 成本利润约束建模 | 使用 `cvxpy` 表达约束与目标函数 |

---

## 📊 模型关键结果展示

### 🔮 Prophet 预测示例

<img src="figures/prophet_forecast_example.png" width="600"/>

- 蓝线为真实销量，黑线为模型预测；
- 可观察到明显的节假日跳跃及周波动。

### 🧠 优化策略示例表格

| 单品名称 | 成本价 | 建议售价 | 预测销量 | 利润贡献 |
|----------|--------|----------|----------|-----------|
| 西兰花   | 4.2 元 | 6.8 元   | 98 kg    | 254.8 元   |
| 胡萝卜   | 2.3 元 | 3.6 元   | 120 kg   | 156 元     |

> 通过模拟退火模型迭代优化，结合销量预测，实现最大化收益策略。

---

## 🗂️ 项目结构说明

| 目录 / 文件       | 描述 |
|------------------|------|
| `notebooks/`     | 所有分析与建模的 Jupyter Notebook 示例 |
| `src/`           | 核心函数封装模块（如建模、优化函数） |
| `data/`          | 原始数据与预处理后的数据集 |
| `figures/`       | 自动生成的可视化图像 |
| `reports/`       | 模型总结报告、可交付文档 |
| `requirements.txt` | 项目依赖包列表 |

---

## 🧱 模块与方法对照表

| 模块文件 | 功能 | 关键技术 |
|----------|------|-----------|
| `data_cleaning.py` | 数据清洗与合并 | 缺失值填充、异常剔除 |
| `eda_analysis.py`  | EDA 可视化分析 | 热力图、堆叠柱状图 |
| `arima_model.py`   | ARIMA 模型预测 | statsmodels |
| `prophet_model.py` | 需求预测建模 | fbprophet |
| `optimizer.py`     | 价格策略优化 | 模拟退火、遗传算法 |
| `pricing_miqp.py`  | 补货规划优化 | 混合整数二次规划 |
| `plotting.py`      | 图像绘制模块 | matplotlib / seaborn |

---

## 🧬 项目优势与创新点

- ✅ **多源数据融合建模**：融合价格、销量、分类信息，实现完整建模闭环；
- ✅ **可解释性强的预测模型**：ARIMA + Prophet 双模结合，提高预测稳健性；
- ✅ **模块化优化策略输出**：单品 / 分类两层优化，灵活应对多种场景；
- ✅ **可视化支持丰富**：销售趋势、类别相关性、补货模拟等全链路图示；
- ✅ **易于迁移与迭代**：明确的目录结构与函数封装，方便未来部署与优化。

---

## 🔭 展望与未来工作

- 接入实时销售数据流，实现动态预测与智能补货；
- 加入天气、节假日等外部因子增强预测准确性；
- 引入库存约束与损耗机制，提升模型实用性；
- 构建可交互式仪表盘，面向运营人员部署。

---

## 📜 License

本项目遵循 MIT License，欢迎学术交流与非商业使用。

---
